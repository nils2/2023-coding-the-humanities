
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Data Wrangling &#8212; 2023-coding-the-humanities</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with Tweets" href="5_WorkingTweets.html" />
    <link rel="prev" title="Reading and writing files, JSON" href="3_ReadingAndWritingFiles.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">2023-coding-the-humanities</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Coding the Humanities
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Setup
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="setup.html">
   Working environment setup
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 0
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="0_HelloWorld.html">
   Getting started
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Basics.html">
   Python basics 1
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2_InputOutput.html">
   Python basics 2 + Input / Output
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 3
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="3_ReadingAndWritingFiles.html">
   Reading and writing files, JSON
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 4
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Data Wrangling
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 5
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="5_WorkingTweets.html">
   Working with Tweets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 6 (Optional)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="6_WebScraping.html">
   Web Scraping and APIs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 7 (Optional)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="7_WorkingTexts.html">
   Working with texts
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/4_PandasDataWrangling.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/bloemj/2022-coding-the-humanities"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/bloemj/2022-coding-the-humanities/issues/new?title=Issue%20on%20page%20%2Fnotebooks/4_PandasDataWrangling.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com//github/bloemj/2022-coding-the-humanities/blob/master/notebooks/4_PandasDataWrangling.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Data Wrangling
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#contents">
     Contents:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#string-formatting">
     String formatting
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regular-expressions">
     Regular expressions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#quiz">
       Quiz
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-with-pandas">
   Data wrangling with Pandas
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#csv-in-pandas">
     CSV (in Pandas)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe">
       <code class="docutils literal notranslate">
        <span class="pre">
         DataFrame
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#statistics">
       Statistics
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#slicing-and-selecting">
       Slicing and selecting
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#df-column1">
         <code class="docutils literal notranslate">
          <span class="pre">
           df['column1']
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#df-column1-column2">
         <code class="docutils literal notranslate">
          <span class="pre">
           df[['column1',
          </span>
          <span class="pre">
           'column2']]
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#looping-over-dataframes">
       Looping over DataFrames
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#zip-df-column1-df-column2">
         <code class="docutils literal notranslate">
          <span class="pre">
           zip(df['column1',
          </span>
          <span class="pre">
           df['column2')
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#to-dict-orient-record">
         <code class="docutils literal notranslate">
          <span class="pre">
           .to_dict(orient='record')
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#iterrows">
         <code class="docutils literal notranslate">
          <span class="pre">
           .iterrows()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis">
       Analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting">
       Plotting
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#grouping">
       Grouping
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-a-column">
       Adding a column
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#saving-back-the-file">
       Saving back the file
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-example">
   Data wrangling (example)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-dataset">
     Load dataset
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selection">
     Selection
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#renaming-columns">
       Renaming columns
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selecting-columns">
       Selecting columns
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selecting-rows">
       Selecting rows
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformation">
     Transformation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-link-to-original-tweet">
       Add link to original tweet
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-colums-with-mentions">
       Add colums with mentions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-column-with-week-day-and-hour">
       Add column with week day and hour
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-column-with-day-hour">
       Add column with day hour
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#multiple-conditions">
         Multiple conditions
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregation">
     Aggregation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Grouping
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#by-label-column">
         By label (column)
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#by-series-or-dict">
         By series or dict
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#by-multiple-labels-columns">
         By multiple labels (columns)
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregation-methods">
       Aggregation methods
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting">
       Sorting
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save">
     Save
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-2">
     Part 2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#describe">
       <code class="docutils literal notranslate">
        <span class="pre">
         describe()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Plotting
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#histograms">
         Histograms
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bar-charts">
         Bar charts
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#box-plots">
         Box plots
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#outliers-missing-values">
       Outliers, missing values
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-1">
       Exercise 1.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-2">
       Exercise 2.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Data Wrangling</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Data Wrangling
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#contents">
     Contents:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#string-formatting">
     String formatting
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regular-expressions">
     Regular expressions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#quiz">
       Quiz
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-with-pandas">
   Data wrangling with Pandas
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#csv-in-pandas">
     CSV (in Pandas)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dataframe">
       <code class="docutils literal notranslate">
        <span class="pre">
         DataFrame
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#statistics">
       Statistics
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#slicing-and-selecting">
       Slicing and selecting
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#df-column1">
         <code class="docutils literal notranslate">
          <span class="pre">
           df['column1']
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#df-column1-column2">
         <code class="docutils literal notranslate">
          <span class="pre">
           df[['column1',
          </span>
          <span class="pre">
           'column2']]
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#looping-over-dataframes">
       Looping over DataFrames
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#zip-df-column1-df-column2">
         <code class="docutils literal notranslate">
          <span class="pre">
           zip(df['column1',
          </span>
          <span class="pre">
           df['column2')
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#to-dict-orient-record">
         <code class="docutils literal notranslate">
          <span class="pre">
           .to_dict(orient='record')
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#iterrows">
         <code class="docutils literal notranslate">
          <span class="pre">
           .iterrows()
          </span>
         </code>
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysis">
       Analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting">
       Plotting
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#grouping">
       Grouping
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-a-column">
       Adding a column
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#saving-back-the-file">
       Saving back the file
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-example">
   Data wrangling (example)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-dataset">
     Load dataset
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selection">
     Selection
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#renaming-columns">
       Renaming columns
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selecting-columns">
       Selecting columns
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#selecting-rows">
       Selecting rows
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformation">
     Transformation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-link-to-original-tweet">
       Add link to original tweet
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-colums-with-mentions">
       Add colums with mentions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-column-with-week-day-and-hour">
       Add column with week day and hour
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-column-with-day-hour">
       Add column with day hour
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#multiple-conditions">
         Multiple conditions
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregation">
     Aggregation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Grouping
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#by-label-column">
         By label (column)
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#by-series-or-dict">
         By series or dict
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#by-multiple-labels-columns">
         By multiple labels (columns)
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregation-methods">
       Aggregation methods
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sorting">
       Sorting
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#save">
     Save
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-2">
     Part 2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#describe">
       <code class="docutils literal notranslate">
        <span class="pre">
         describe()
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Plotting
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#histograms">
         Histograms
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#bar-charts">
         Bar charts
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#box-plots">
         Box plots
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#outliers-missing-values">
       Outliers, missing values
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-1">
       Exercise 1.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-2">
       Exercise 2.
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="data-wrangling">
<h1>Data Wrangling<a class="headerlink" href="#data-wrangling" title="Permalink to this headline">¶</a></h1>
<section id="contents">
<h2>Contents:<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>String formatting (f-strings)</p></li>
<li><p>Regular expressions (regex)</p></li>
<li><p>Pandas (Reading/writing CSV)</p></li>
</ul>
</section>
<section id="string-formatting">
<h2>String formatting<a class="headerlink" href="#string-formatting" title="Permalink to this headline">¶</a></h2>
<p>Instead of writing a series of <code class="docutils literal notranslate"><span class="pre">print()</span></code> statements with multiple arguments, or concatenating (by <code class="docutils literal notranslate"><span class="pre">+</span></code>) strings, you can also use a Python string formatting method, called <code class="docutils literal notranslate"><span class="pre">f-strings</span></code>. More information can be read in PEP 498: <a class="reference external" href="https://www.python.org/dev/peps/pep-0498/">https://www.python.org/dev/peps/pep-0498/</a></p>
<p>You can define a string as a template by inserting <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">}</span></code> characters with a variable name or expression in between. For this to work, you have to type an <code class="docutils literal notranslate"><span class="pre">f</span></code> in front of the <code class="docutils literal notranslate"><span class="pre">'</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;</span></code> start of the string definition. When defined, the string will read with the string value of the variable or the expression filled in.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Joe&quot;</span>
<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;My name is </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>
</pre></div>
</div>
<p>Again, if you need a <code class="docutils literal notranslate"><span class="pre">'</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> in your expression, use the other variant in the Python source code to declare the string. Writing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s1">&#39;This is my </span><span class="si">{</span><span class="n">example</span><span class="si">}</span><span class="s1">.&#39;</span>
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sa">f</span><span class="s2">&quot;This is my </span><span class="si">{</span><span class="n">example</span><span class="si">}</span><span class="s2">.&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Joe&quot;</span>
<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;My name is </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>My name is Joe.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">day</span> <span class="o">=</span> <span class="s2">&quot;Monday&quot;</span>
<span class="n">weather</span> <span class="o">=</span> <span class="s2">&quot;Sunny&quot;</span>
<span class="n">n_messages</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">test_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="s1">&#39;test_value&#39;</span><span class="p">}</span>

<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Today is </span><span class="si">{</span><span class="n">day</span><span class="si">}</span><span class="s2">. </span>
<span class="s2">The weather is </span><span class="si">{</span><span class="n">weather</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2"> and you have </span><span class="si">{</span><span class="n">n_messages</span><span class="si">}</span><span class="s2"> unread messages. </span>
<span class="s2">The first three letters of the weekday: </span><span class="si">{</span><span class="n">day</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2"></span>
<span class="s2">An example expression is: </span><span class="si">{</span><span class="mi">15</span> <span class="o">**</span> <span class="mi">2</span> <span class="si">= }</span><span class="s2"></span>



<span class="s2">&quot;&quot;&quot;</span>

<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Test by selecting key: </span><span class="si">{</span><span class="n">test_dict</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>


<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test by selecting key: test_value
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="regular-expressions">
<h2>Regular expressions<a class="headerlink" href="#regular-expressions" title="Permalink to this headline">¶</a></h2>
<p>Using regular expressions can be very useful when working with texts. It is a powerful search mechanism by which you can search on patterns, instead of ‘exact matches’. But, they can be difficult to grasp, at first sight.</p>
<p>A <strong>regular expression</strong>, for instance, allows you to substitute all digits in a text, following another text sequence, or to find all urls, phone numbers, or email addresses. Or any text, that meets a particular condition.</p>
<p>See the Python manual for the <code class="docutils literal notranslate"><span class="pre">re</span></code> module for more info: <a class="reference external" href="https://docs.python.org/3/library/re.html">https://docs.python.org/3/library/re.html</a></p>
<p>You can/should use a cheatsheet when writing a regular expression. A nice website to write and test them is: <a class="reference external" href="https://regex101.com/">https://regex101.com/</a>.</p>
<p>Some examples of commonly used expressions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">\d</span></code> for all digits 0-9</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\w</span></code> for any word character</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[abc]</span></code> for a set of characters (here: a, b, c)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.</span></code> any character</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">?</span></code> the preceding character/pattern 0 or 1 times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*</span></code> the preceding character/pattern 0 or multiple times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+</span></code> the preceding character/pattern 1 or multiple times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{1,2}</span></code> 1 or 2 times</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^</span></code> the start of the string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span></code> the end of the string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">()</span></code> capture group (only return this part)</p></li>
</ul>
<p>In many text editors (e.g. VSCode) there is also an option to search (and replace) with the help of regular expressions.</p>
<p>Python has a regex module built in. When working with a regular expression, you have to import it first:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
</pre></div>
</div>
</div>
</div>
<p>You can use a regular expression for <strong>finding</strong> occurences in a text. Let’s say we want to filter out all web urls in a text:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">There are various search engines on the web. </span>
<span class="s2">There is https://www.google.com/, but also https://www.bing.com/. </span>
<span class="s2">A more privacy friendly alternative is https://duckduckgo.com/. </span>
<span class="s2">And who remembers http://www.altavista.com/?</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https?://.+?/&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;https://www.google.com/&#39;,
 &#39;https://www.bing.com/&#39;,
 &#39;https://duckduckgo.com/&#39;,
 &#39;http://www.altavista.com/&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copied from https://www.imdb.com/search/title/?groups=top_250&amp;sort=user_rating</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">1. The Shawshank Redemption (1994)</span>
<span class="s2">12 | 142 min | Drama</span>

<span class="s2"> 9,3  Rate this 80 Metascore</span>
<span class="s2">Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.</span>

<span class="s2">Director: Frank Darabont | Stars: Tim Robbins, Morgan Freeman, Bob Gunton, William Sadler</span>

<span class="s2">Votes: 2.355.643 | Gross: $28.34M</span>

<span class="s2">2. The Godfather (1972)</span>
<span class="s2">16 | 175 min | Crime, Drama</span>

<span class="s2"> 9,2  Rate this 100 Metascore</span>
<span class="s2">An organized crime dynasty&#39;s aging patriarch transfers control of his clandestine empire to his reluctant son.</span>

<span class="s2">Director: Francis Ford Coppola | Stars: Marlon Brando, Al Pacino, James Caan, Diane Keaton</span>

<span class="s2">Votes: 1.630.157 | Gross: $134.97M</span>

<span class="s2">3. The Dark Knight (2008)</span>
<span class="s2">16 | 152 min | Action, Crime, Drama</span>

<span class="s2"> 9,0  Rate this 84 Metascore</span>
<span class="s2">When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.</span>

<span class="s2">Director: Christopher Nolan | Stars: Christian Bale, Heath Ledger, Aaron Eckhart, Michael Caine</span>

<span class="s2">Votes: 2.315.134 | Gross: $534.86M</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">titles</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d{1,2}\. (.+)&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">titles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;The Shawshank Redemption (1994)&#39;,
 &#39;The Godfather (1972)&#39;,
 &#39;The Dark Knight (2008)&#39;]
</pre></div>
</div>
</div>
</div>
<section id="quiz">
<h3>Quiz<a class="headerlink" href="#quiz" title="Permalink to this headline">¶</a></h3>
<p>Try to get a list of all directors. And the gross income.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># All directors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gross income</span>
</pre></div>
</div>
</div>
</div>
<p>Or, you can use a regular expression to <strong>replace</strong> a character sequence. This is an equivalent to the <code class="docutils literal notranslate"><span class="pre">.replace()</span></code> function, but allows more variance in the string matching.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Tim Robbins</span>
<span class="s2">Morgan Freeman</span>
<span class="s2">Bob Gunton</span>
<span class="s2">William Sadler</span>
<span class="s2">Marlon Brando</span>
<span class="s2">Al Pacino</span>
<span class="s2">James Caan</span>
<span class="s2">Diane Keaton</span>
<span class="s2">Christian Bale</span>
<span class="s2">Heath Ledger</span>
<span class="s2">Aaron Eckhart</span>
<span class="s2">Michael Caine</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Hint: test this with https://regex101.com/</span>
<span class="n">new_text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?:(\w)\w+) (\w+)&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\1. \2&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T. Robbins
M. Freeman
B. Gunton
W. Sadler
M. Brando
A. Pacino
J. Caan
D. Keaton
C. Bale
H. Ledger
A. Eckhart
M. Caine
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="data-wrangling-with-pandas">
<h1>Data wrangling with Pandas<a class="headerlink" href="#data-wrangling-with-pandas" title="Permalink to this headline">¶</a></h1>
<section id="csv-in-pandas">
<h2>CSV (in Pandas)<a class="headerlink" href="#csv-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>The other often used file type is CSV (Comma Separated Values), or variants, such as TSV (Tab Separated Values). Python includes another built-in module to deal with these files: the <code class="docutils literal notranslate"><span class="pre">csv</span></code> module. But, we will be using the <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> module, the go-to package for data analysis, that you already imported and updated in Notebook 0.</p>
<p>A CSV file is similar to an Excel or Google Docs spreadsheet, but more limited in markup and functionality (e.g. you cannot store Excel functions). It is just a text file in which individual entries correspond to lines, and columns are separated by a comma. You can always open a CSV file with a text editor, and this also makes it so easy to store and share data with.</p>
<p>For the rest of the notebook we will see how to work with the two main data types in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>: the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and a <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p>Information on functions and modules of Pandas cannot be found in the Python manual online, as it is an external package. Instead, you can refer to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/index.html">https://pandas.pydata.org/pandas-docs/stable/index.html</a> .</p>
<section id="dataframe">
<h3><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#dataframe" title="Permalink to this headline">¶</a></h3>
<p>What is a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>?</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is a collection of <code class="docutils literal notranslate"><span class="pre">Series</span></code> having the same length and whose indexes are in sync. A <em>collection</em> means that each column of a dataframe is a series. You can also see it as a spreadheet in memory, that also allows for inclusion of Python objects.</p>
<p>We first have to import the package. It’s a convention to do this like so with Pandas, which makes the elements from this package (classes, functions, methods) available under its abbreviation <code class="docutils literal notranslate"><span class="pre">pd</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Next is loading the data. The following data comes from Wikipedia and was <a class="reference external" href="https://query.wikidata.org/#%0ASELECT%20DISTINCT%20%3FmovieLabel%20%3Fimdb%20%28MIN%28%3FpublicationYear%29%20as%20%3Fyear%29%20%28year%28%3Fdate%29%20as%20%3Faward_year%29%20%28group_concat%28DISTINCT%20%3FdirectorLabel%3Bseparator%3D%22%2C%20%22%29%20as%20%3Fdirectors%20%29%20%28group_concat%28DISTINCT%20%3FcompanyLabel%3Bseparator%3D%22%2C%20%22%29%20as%20%3Fcompanies%29%20%3Fmale_cast%20%3Ffemale_cast%20WHERE%20%7B%0A%20%20%0A%20%20%7B%0A%20%20%3Fmovie%20p%3AP166%20%3Fawardstatement%20%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP345%20%3Fimdb%20%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP577%20%3Fpublication%20%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP57%20%3Fdirector%20%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP272%20%3Fcompany%20%3B%0A%20%20%20%20%20%20%20%20%20wdt%3AP31%20wd%3AQ11424%20.%0A%20%20%0A%20%20%3Fawardstatement%20ps%3AP166%20wd%3AQ102427%20%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pq%3AP585%20%3Fdate%20.%0A%20%20%7D%0A%20%20%0A%20%20BIND%28year%28%3Fpublication%29%20as%20%3FpublicationYear%29%0A%20%20%0A%20%20%7B%0A%20%20%20%20%20SELECT%20%3Fmovie%20%28COUNT%28%3Fcast_member%29%20AS%20%3Fmale_cast%29%20WHERE%20%7B%0A%20%20%20%20%20%20%3Fmovie%20wdt%3AP161%20%3Fcast_member%20.%0A%20%20%20%20%20%20%3Fcast_member%20wdt%3AP21%20wd%3AQ6581097%20.%0A%20%20%20%20%7D%20GROUP%20BY%20%3Fmovie%0A%7D%20%7B%0A%20%20%20%20SELECT%20%3Fmovie%20%28COUNT%28%3Fcast_member%29%20AS%20%3Ffemale_cast%29%20WHERE%20%7B%0A%20%20%20%20%20%20%3Fmovie%20wdt%3AP161%20%3Fcast_member%20.%0A%20%20%20%20%20%20%3Fcast_member%20wdt%3AP21%20wd%3AQ6581072%20.%0A%20%20%20%20%7D%20GROUP%20BY%20%3Fmovie%0A%20%20%7D%0A%20%20%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20%0A%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22en%22%20.%0A%20%20%20%20%3Fmovie%20rdfs%3Alabel%20%3FmovieLabel%20.%0A%20%20%20%20%3Fdirector%20rdfs%3Alabel%20%3FdirectorLabel%20.%0A%20%20%20%20%3Fcompany%20rdfs%3Alabel%20%3FcompanyLabel%20.%20%0A%20%20%7D%0A%7D%20%0A%0AGROUP%20BY%20%3FmovieLabel%20%3Fimdb%20%3Fdate%20%3Fmale_cast%20%3Ffemale_cast%0AORDER%20BY%20%3Fyear%20">automatically</a> retreived. It is an overview of all movies that have won an Academy Award for Best Picture, including some extra data for the movie: a link to the IMDB, the publication and award year, the director(s), production company and the number of male and female actors in the cast. It can be that this data is incorrect, because this information is not entered in Wikipedia.</p>
<p>You can find this file in <code class="docutils literal notranslate"><span class="pre">data/academyawards.csv</span></code>. Download it from the repository and save it in the data folder if you don’t have it.</p>
<p>Reading in a csv with pandas is easy. We call the <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> function with the file path as argument. Pandas takes care of opening and closing the file, so a <code class="docutils literal notranslate"><span class="pre">with</span></code> statement is not needed. The contents of the csv file are then read in a Pandas DataFrame object. We can store this in the variable <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<p>Calling this variable in a Jypyter Notebook gives back a nicely formatted table with the first and last 5 rows of the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/academyawards.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927</td>
      <td>1929</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929</td>
      <td>1930</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930</td>
      <td>1930</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931</td>
      <td>1931</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932</td>
      <td>1932</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015</td>
      <td>2016</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016</td>
      <td>2017</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017</td>
      <td>2018</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018</td>
      <td>2019</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019</td>
      <td>2020</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
<p>Think of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as an in-memory spreadsheet that you can analyse and manipulate programmatically. Or, think of it as a table in which every line is a data entry, and every column holds specific information on this data.</p>
<p>These columns can also be seen as lists of values. They are ordered and the index of an element corresponds with the index of the data entry. The collection of all such columns is what makes the DataFrame. One column in a table is represented by a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>, which collects observations about a given variable. Multiple columns are a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. A DataFrame therefore is a collection of lists (=columns), or <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p>If you look for other methods on <code class="docutils literal notranslate"><span class="pre">pd</span></code> you can call, you’ll also see that there is an <code class="docutils literal notranslate"><span class="pre">pd.read_excel()</span></code> option to read spreadsheets in <code class="docutils literal notranslate"><span class="pre">.xls</span></code> or <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>. You can also  use this, if you have these kind of files.</p>
</section>
<section id="statistics">
<h3>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h3>
<p>Now that we loaded our DataFrame, we can make pandas print some statistics on the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># First 5 rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927</td>
      <td>1929</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>  <span class="c1"># Last 5 rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015</td>
      <td>2016</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016</td>
      <td>2017</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017</td>
      <td>2018</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018</td>
      <td>2019</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019</td>
      <td>2020</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>  <span class="c1"># Descriptive statistics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>award_year</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>85.000000</td>
      <td>85.000000</td>
      <td>85.000000</td>
      <td>85.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1974.164706</td>
      <td>1975.164706</td>
      <td>16.858824</td>
      <td>5.835294</td>
    </tr>
    <tr>
      <th>std</th>
      <td>27.288951</td>
      <td>27.350828</td>
      <td>12.125488</td>
      <td>4.369393</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1927.000000</td>
      <td>1929.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1950.000000</td>
      <td>1951.000000</td>
      <td>9.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1975.000000</td>
      <td>1976.000000</td>
      <td>14.000000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1998.000000</td>
      <td>1999.000000</td>
      <td>21.000000</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2019.000000</td>
      <td>2020.000000</td>
      <td>89.000000</td>
      <td>29.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see by what they return, these methods return another DataFrame with some descriptive statistics on the file, such as the number of entries (count), the mean of the numerical values, the standard deviation, minimum and maximum values, and the 25th, 50th, and 75th percentiles.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.info()</span></code> method can also be informative. It gives you information about a dataframe:</p>
<ul class="simple">
<li><p>how much space does it take in memory?</p></li>
<li><p>what is the datatype of each column?</p></li>
<li><p>how many records are there?</p></li>
<li><p>how many <code class="docutils literal notranslate"><span class="pre">null</span></code> values does each column contain (!)?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 85 entries, 0 to 84
Data columns (total 8 columns):
 #   Column       Non-Null Count  Dtype 
---  ------       --------------  ----- 
 0   movie        85 non-null     object
 1   imdb         85 non-null     object
 2   year         85 non-null     int64 
 3   award_year   85 non-null     int64 
 4   directors    85 non-null     object
 5   companies    85 non-null     object
 6   male_cast    85 non-null     int64 
 7   female_cast  85 non-null     int64 
dtypes: int64(4), object(4)
memory usage: 5.4+ KB
</pre></div>
</div>
</div>
</div>
<p>Pandas automatically interprets which datatypes are used in the file, but this is not always correct. Especially if you have empty fields in the DataFrame, any other integers get interpreted as float. Every column has one datatype. You can check them separately by requesting the <code class="docutils literal notranslate"><span class="pre">.dtypes</span></code> argument on the <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<p>The ‘object’ type is a string in this file, ‘int64’ is an integer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movie          object
imdb           object
year            int64
award_year      int64
directors      object
companies      object
male_cast       int64
female_cast     int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We expect different datatypes for the description-dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">description_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">description_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year           float64
award_year     float64
male_cast      float64
female_cast    float64
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="slicing-and-selecting">
<h3>Slicing and selecting<a class="headerlink" href="#slicing-and-selecting" title="Permalink to this headline">¶</a></h3>
<section id="df-column1">
<h4><code class="docutils literal notranslate"><span class="pre">df['column1']</span></code><a class="headerlink" href="#df-column1" title="Permalink to this headline">¶</a></h4>
<p>You can select a single column by calling this column name as if the DataFrame was a dictionary. A single column from a DataFrame returns a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927</td>
      <td>1929</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929</td>
      <td>1930</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930</td>
      <td>1930</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931</td>
      <td>1931</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932</td>
      <td>1932</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015</td>
      <td>2016</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016</td>
      <td>2017</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017</td>
      <td>2018</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018</td>
      <td>2019</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019</td>
      <td>2020</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;movie&#39;</span><span class="p">]))</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;movie&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0                              Wings
1                The Broadway Melody
2     All Quiet on the Western Front
3                           Cimarron
4                        Grand Hotel
                   ...              
80                         Spotlight
81                         Moonlight
82                The Shape of Water
83                        Green Book
84                          Parasite
Name: movie, Length: 85, dtype: object
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Series</span></code> object is very similar to a <code class="docutils literal notranslate"><span class="pre">list</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;movie&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Length:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">movies</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">movie</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">movies</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">movie</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length: 85

1	Wings
2	The Broadway Melody
3	All Quiet on the Western Front
4	Cimarron
5	Grand Hotel
6	It Happened One Night
7	Mutiny on the Bounty
8	The Great Ziegfeld
9	The Life of Emile Zola
10	You Can&#39;t Take It With You
</pre></div>
</div>
</div>
</div>
</section>
<section id="df-column1-column2">
<h4><code class="docutils literal notranslate"><span class="pre">df[['column1',</span> <span class="pre">'column2']]</span></code><a class="headerlink" href="#df-column1-column2" title="Permalink to this headline">¶</a></h4>
<p>We can also slice a DataFrame by calling multiple column names as one list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;movie&#39;</span><span class="p">,</span> <span class="s1">&#39;imdb&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 2 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="looping-over-dataframes">
<h3>Looping over DataFrames<a class="headerlink" href="#looping-over-dataframes" title="Permalink to this headline">¶</a></h3>
<p>You might expect that if you loop through a DataFrame, you get all the rows. Sadly, it is not that simple, because we now have data in two dimensions. We instead get all the column names (or the first row of the dataframe):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movie
imdb
year
award_year
directors
companies
male_cast
female_cast
</pre></div>
</div>
</div>
</div>
<section id="zip-df-column1-df-column2">
<h4><code class="docutils literal notranslate"><span class="pre">zip(df['column1',</span> <span class="pre">df['column2')</span></code><a class="headerlink" href="#zip-df-column1-df-column2" title="Permalink to this headline">¶</a></h4>
<p>Going over these items in a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop needs a different approach. The built-in <code class="docutils literal notranslate"><span class="pre">zip()</span></code> function (<a class="reference external" href="https://docs.python.org/3/library/functions.html#zip">manual</a>) takes two iterables of even length and creates a new iterable of tuples. The number of arguments/iterables that you give to <code class="docutils literal notranslate"><span class="pre">zip()</span></code> determines the length of the tuples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="n">list2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 3)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">movie</span><span class="p">,</span> <span class="n">imdb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;movie&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;imdb&#39;</span><span class="p">]):</span>
    
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
        <span class="k">break</span>  <span class="c1"># stop flooding the Notebook</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">movie</span><span class="p">,</span> <span class="s2">&quot;http://www.imdb.com/title/&quot;</span> <span class="o">+</span> <span class="n">imdb</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wings	http://www.imdb.com/title/tt0018578
The Broadway Melody	http://www.imdb.com/title/tt0019729
All Quiet on the Western Front	http://www.imdb.com/title/tt0020629
Cimarron	http://www.imdb.com/title/tt0021746
Grand Hotel	http://www.imdb.com/title/tt0022958
It Happened One Night	http://www.imdb.com/title/tt0025316
Mutiny on the Bounty	http://www.imdb.com/title/tt0026752
The Great Ziegfeld	http://www.imdb.com/title/tt0027698
The Life of Emile Zola	http://www.imdb.com/title/tt0029146
You Can&#39;t Take It With You	http://www.imdb.com/title/tt0030993
</pre></div>
</div>
</div>
</div>
</section>
<section id="to-dict-orient-record">
<h4><code class="docutils literal notranslate"><span class="pre">.to_dict(orient='record')</span></code><a class="headerlink" href="#to-dict-orient-record" title="Permalink to this headline">¶</a></h4>
<p>Or, accessing all entries in a convenient way, as a python dictionary for instance, can be done with the <code class="docutils literal notranslate"><span class="pre">.to_dict(orient='records')</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927</td>
      <td>1929</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    
    <span class="n">name</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;movie&#39;</span><span class="p">]</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
    <span class="n">won</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;award_year&#39;</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The movie &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; was produced in &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; and won in &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">won</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">()</span>
    
    <span class="k">break</span>  <span class="c1"># To not flood the notebook, only print the first</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;movie&#39;: &#39;Wings&#39;, &#39;imdb&#39;: &#39;tt0018578&#39;, &#39;year&#39;: 1927, &#39;award_year&#39;: 1929, &#39;directors&#39;: &#39;William A. Wellman, Harry d’Abbadie d’Arrast&#39;, &#39;companies&#39;: &#39;Paramount Pictures&#39;, &#39;male_cast&#39;: 12, &#39;female_cast&#39;: 5}

The movie Wings was produced in 1927 and won in 1929.
</pre></div>
</div>
</div>
</div>
</section>
<section id="iterrows">
<h4><code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code><a class="headerlink" href="#iterrows" title="Permalink to this headline">¶</a></h4>
<p>Or you can use the <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code> method, which gives you tuples of the index of the row, and the row itself as <code class="docutils literal notranslate"><span class="pre">Series</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    
    <span class="n">name</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">movie</span>  <span class="c1"># You can use a dot notation here</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">year</span>
    <span class="n">won</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">award_year</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The movie </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> was produced in </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2"> and won in </span><span class="si">{</span><span class="n">won</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">()</span>
    
    <span class="k">break</span>  <span class="c1"># To not flood the notebook, only print the first</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The movie Wings was produced in 1927 and won in 1929.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927</td>
      <td>1929</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929</td>
      <td>1930</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930</td>
      <td>1930</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931</td>
      <td>1931</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932</td>
      <td>1932</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015</td>
      <td>2016</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016</td>
      <td>2017</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017</td>
      <td>2018</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018</td>
      <td>2019</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019</td>
      <td>2020</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_60787/3698961737.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  df.mean()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year           1974.164706
award_year     1975.164706
male_cast        16.858824
female_cast       5.835294
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>You already saw above that you could get statistics by calling <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> on a DataFrame. You can also get these metrics for individual columns. Let’s ask the maximum number of male and female actors in the cast of a movie:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;female_cast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>89
</pre></div>
</div>
</div>
</div>
<p>You can also apply these operations to multiple columns at once. You get a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object back.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>movie          You Can&#39;t Take It With You
imdb                            tt6966692
year                                 2019
award_year                           2020
directors                   William Wyler
companies       Woodfall Film Productions
male_cast                              89
female_cast                            29
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">,</span> <span class="s1">&#39;female_cast&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slice_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">,</span> <span class="s1">&#39;female_cast&#39;</span><span class="p">]]</span>

<span class="n">slice_df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>male_cast      89
female_cast    29
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>To find the corresponding movie title, we can ask Pandas to give us the record in which these maxima occur. This is done through <code class="docutils literal notranslate"><span class="pre">df.loc</span></code>. This works by asking: “Give me all the locations (=rows) for which a value in a specified column is equal to this value”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927</td>
      <td>1929</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929</td>
      <td>1930</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930</td>
      <td>1930</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931</td>
      <td>1931</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932</td>
      <td>1932</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015</td>
      <td>2016</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016</td>
      <td>2017</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017</td>
      <td>2018</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018</td>
      <td>2019</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019</td>
      <td>2020</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">,</span> <span class="s1">&#39;female_cast&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>male_cast      89
female_cast    29
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;female_cast&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>The Great Ziegfeld</td>
      <td>tt0027698</td>
      <td>1936</td>
      <td>1937</td>
      <td>Robert Zigler Leonard</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>22</td>
      <td>17</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Gone with the Wind</td>
      <td>tt0031381</td>
      <td>1939</td>
      <td>1940</td>
      <td>George Cukor, Victor Fleming, Sam Wood</td>
      <td>Metro-Goldwyn-Mayer, Selznick International Pi...</td>
      <td>52</td>
      <td>20</td>
    </tr>
    <tr>
      <th>34</th>
      <td>The Sound of Music</td>
      <td>tt0059742</td>
      <td>1965</td>
      <td>1966</td>
      <td>Robert Wise</td>
      <td>20th Century Studios</td>
      <td>7</td>
      <td>14</td>
    </tr>
    <tr>
      <th>41</th>
      <td>The Godfather Part II</td>
      <td>tt0071562</td>
      <td>1974</td>
      <td>1975</td>
      <td>Francis Ford Coppola</td>
      <td>Paramount Pictures</td>
      <td>33</td>
      <td>12</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Schindler's List</td>
      <td>tt0108052</td>
      <td>1993</td>
      <td>1994</td>
      <td>Steven Spielberg, Marek Brodzki</td>
      <td>Amblin Entertainment</td>
      <td>35</td>
      <td>11</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Forrest Gump</td>
      <td>tt0109830</td>
      <td>1994</td>
      <td>1995</td>
      <td>Robert Zemeckis</td>
      <td>Paramount Pictures</td>
      <td>89</td>
      <td>29</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Crash</td>
      <td>tt0375679</td>
      <td>2004</td>
      <td>2006</td>
      <td>Paul Haggis</td>
      <td>Lionsgate, DEJ Productions, Yari Film Group</td>
      <td>16</td>
      <td>12</td>
    </tr>
    <tr>
      <th>76</th>
      <td>The Artist</td>
      <td>tt1655442</td>
      <td>2011</td>
      <td>2012</td>
      <td>Michel Hazanavicius</td>
      <td>France 3, Wild Bunch</td>
      <td>19</td>
      <td>11</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Birdman</td>
      <td>tt2562232</td>
      <td>2014</td>
      <td>2015</td>
      <td>Alejandro González Iñárritu</td>
      <td>Searchlight Pictures, Worldview Entertainment</td>
      <td>13</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">,</span> <span class="s1">&#39;female_cast&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Movie with maximum for&quot;</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
    <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">movie</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Movie with maximum for male_cast 89
59    Forrest Gump
Name: movie, dtype: object

Movie with maximum for female_cast 29
59    Forrest Gump
Name: movie, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Other functions that can be used are for instance <code class="docutils literal notranslate"><span class="pre">.mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">.median()</span></code>, <code class="docutils literal notranslate"><span class="pre">.std()</span></code> and <code class="docutils literal notranslate"><span class="pre">.sum()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;female_cast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.8352941176470585
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.858823529411765
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;female_cast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>496
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1433
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927</td>
      <td>1929</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929</td>
      <td>1930</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930</td>
      <td>1930</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931</td>
      <td>1931</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932</td>
      <td>1932</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015</td>
      <td>2016</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016</td>
      <td>2017</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017</td>
      <td>2018</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018</td>
      <td>2019</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019</td>
      <td>2020</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
<p>Pandas also understands dates, but you have to tell it to interpret a column as such. We can change the <code class="docutils literal notranslate"><span class="pre">year</span></code> column in-place so that it is not interpreted as integer, but as a date object.</p>
<p>In this case, since we only have the year available, and not a full date such as <code class="docutils literal notranslate"><span class="pre">2021-02-22</span></code> (YYYY-mm-dd), we have to specify the format. Typing <code class="docutils literal notranslate"><span class="pre">%Y</span></code> as string is shorthand for <code class="docutils literal notranslate"><span class="pre">YYYY</span></code>. It returns a full date, so every month and day are set to January first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;award_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;award_year&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1927-01-01
1    1929-01-01
2    1930-01-01
3    1931-01-01
4    1932-01-01
        ...    
80   2015-01-01
81   2016-01-01
82   2017-01-01
83   2018-01-01
84   2019-01-01
Name: year, Length: 85, dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927-01-01</td>
      <td>1929-01-01</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929-01-01</td>
      <td>1930-01-01</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930-01-01</td>
      <td>1930-01-01</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931-01-01</td>
      <td>1931-01-01</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932-01-01</td>
      <td>1932-01-01</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015-01-01</td>
      <td>2016-01-01</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016-01-01</td>
      <td>2017-01-01</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017-01-01</td>
      <td>2018-01-01</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018-01-01</td>
      <td>2019-01-01</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019-01-01</td>
      <td>2020-01-01</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
</section>
<section id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h3>
<p>Let’s try to make some graphs from our data, for instance the number of male/female actors over time.</p>
<p>We now have a year column that is interpreted as time by Pandas. These values can figure as values on a x-axis in a graph. The y-axis would then give info on the number of male and female actors in the movie.</p>
<p>First, we set an <strong>index</strong> for the DataFrame. This determines how the data can be accessed. Normally, this is a range of 0 untill the number of rows. But, you can change this, so that we can analyse the dataframe on a time index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only what we need</span>
<span class="n">df_actors</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;award_year&#39;</span><span class="p">,</span> <span class="s1">&#39;male_cast&#39;</span><span class="p">,</span> <span class="s1">&#39;female_cast&#39;</span><span class="p">]]</span>
<span class="n">df_actors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>award_year</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1929-01-01</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1930-01-01</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1930-01-01</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1931-01-01</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1932-01-01</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>2016-01-01</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>2017-01-01</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>2018-01-01</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>2019-01-01</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>2020-01-01</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_actors</span> <span class="o">=</span> <span class="n">df_actors</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;award_year&#39;</span><span class="p">)</span>
<span class="n">df_actors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
    <tr>
      <th>award_year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1929-01-01</th>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1930-01-01</th>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1930-01-01</th>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1931-01-01</th>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1932-01-01</th>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-01-01</th>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2017-01-01</th>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2018-01-01</th>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2019-01-01</th>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2020-01-01</th>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 2 columns</p>
</div></div></div>
</div>
<p>Then simply call <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> on your newly created DataFrame!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_actors</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;award_year&#39;&gt;
</pre></div>
</div>
<img alt="../_images/4_PandasDataWrangling_91_1.png" src="../_images/4_PandasDataWrangling_91_1.png" />
</div>
</div>
<p>There are tons of parameters, functions, methods, transformations you can use on DataFrames and also on this plotting function. Luckily, plenty of guides and examples can be found on the internet.</p>
</section>
<section id="grouping">
<h3>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927-01-01</td>
      <td>1929-01-01</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929-01-01</td>
      <td>1930-01-01</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930-01-01</td>
      <td>1930-01-01</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931-01-01</td>
      <td>1931-01-01</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932-01-01</td>
      <td>1932-01-01</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015-01-01</td>
      <td>2016-01-01</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016-01-01</td>
      <td>2017-01-01</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017-01-01</td>
      <td>2018-01-01</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018-01-01</td>
      <td>2019-01-01</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019-01-01</td>
      <td>2020-01-01</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
<p>Some directors have won multiple Oscars. To find out which, we have to count the number of rows in the DataFrame that include the same director. There is a Pandas function for this: <code class="docutils literal notranslate"><span class="pre">.count()</span></code>. Calling this on the DataFrame itself would give us the total number of rows only, per column. Therefore, we have to tell Pandas that we want to group by a particular column, say ‘directors’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;directors&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f257615d550&gt;
</pre></div>
</div>
</div>
</div>
<p>It does not give back something nicely formatted or interpretable. It’s just another Python object. The object returned by <code class="docutils literal notranslate"><span class="pre">groupby</span></code> is a <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> <strong>not</strong> a normal <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>However, some methods of the latter work also on the former, e.g. <code class="docutils literal notranslate"><span class="pre">.head()</span></code> and <code class="docutils literal notranslate"><span class="pre">.tail()</span></code>. Let’s call the <code class="docutils literal notranslate"><span class="pre">.count()</span></code> on this object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;directors&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
    <tr>
      <th>directors</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alejandro González Iñárritu</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Alfred Hitchcock</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Anthony Minghella</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Barry Jenkins</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Barry Levinson</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Vincente Minnelli, Charles Walters</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Wesley Ruggles</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>William A. Wellman, Harry d’Abbadie d’Arrast</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>William Dieterle</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>William Wyler</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>76 rows × 7 columns</p>
</div></div></div>
</div>
<p>Remember that this counts the numer of rows. As we know that each row is one movie, we can trim this down to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">director_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;directors&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s1">&#39;movie&#39;</span><span class="p">]</span>
<span class="n">director_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>directors
Alejandro González Iñárritu                     1
Alfred Hitchcock                                1
Anthony Minghella                               1
Barry Jenkins                                   1
Barry Levinson                                  1
                                               ..
Vincente Minnelli, Charles Walters              1
Wesley Ruggles                                  1
William A. Wellman, Harry d’Abbadie d’Arrast    1
William Dieterle                                1
William Wyler                                   3
Name: movie, Length: 76, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Now, get all directors that have won an Oscar more than once by specifying a conditional operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">director_counts</span><span class="p">[</span><span class="n">director_counts</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>directors
Billy Wilder            2
Clint Eastwood          2
Elia Kazan              2
Francis Ford Coppola    2
Frank Capra             2
Fred Zinnemann          2
Miloš Forman            2
William Wyler           3
Name: movie, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">director_counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Alejandro González Iñárritu&#39;, 1),
 (&#39;Alfred Hitchcock&#39;, 1),
 (&#39;Anthony Minghella&#39;, 1),
 (&#39;Barry Jenkins&#39;, 1),
 (&#39;Barry Levinson&#39;, 1),
 (&#39;Ben Affleck&#39;, 1),
 (&#39;Bernardo Bertolucci&#39;, 1),
 (&#39;Billy Wilder&#39;, 2),
 (&#39;Bong Joon-ho&#39;, 1),
 (&#39;Bruce Beresford&#39;, 1),
 (&#39;Carol Reed&#39;, 1),
 (&#39;Cecil B. DeMille&#39;, 1),
 (&#39;Clint Eastwood&#39;, 2),
 (&#39;Danny Boyle, Loveleen Tandan&#39;, 1),
 (&#39;David Lean&#39;, 1),
 (&#39;Delbert Mann, Paul Helmick&#39;, 1),
 (&#39;Edmund Goulding&#39;, 1),
 (&#39;Elia Kazan&#39;, 2),
 (&#39;Francis Ford Coppola&#39;, 2),
 (&#39;Frank Capra&#39;, 2),
 (&#39;Frank Lloyd&#39;, 1),
 (&#39;Fred Zinnemann&#39;, 2),
 (&#39;George Cukor&#39;, 1),
 (&#39;George Cukor, Victor Fleming, Sam Wood&#39;, 1),
 (&#39;George Roy Hill&#39;, 1),
 (&#39;Guillermo del Toro&#39;, 1),
 (&#39;Harry Beaumont&#39;, 1),
 (&#39;Hugh Hudson&#39;, 1),
 (&#39;James Cameron&#39;, 1),
 (&#39;James L. Brooks&#39;, 1),
 (&#39;Joel Coen, Ethan Coen&#39;, 1),
 (&#39;John Ford&#39;, 1),
 (&#39;John G. Avildsen&#39;, 1),
 (&#39;John Madden&#39;, 1),
 (&#39;John Schlesinger&#39;, 1),
 (&#39;Jonathan Demme&#39;, 1),
 (&#39;Joseph L. Mankiewicz&#39;, 1),
 (&#39;Kathryn Bigelow&#39;, 1),
 (&#39;Kevin Costner&#39;, 1),
 (&#39;Laurence Olivier&#39;, 1),
 (&#39;Leo McCarey&#39;, 1),
 (&#39;Lewis Milestone, Nate Watt&#39;, 1),
 (&#39;Martin Scorsese&#39;, 1),
 (&#39;Mel Gibson&#39;, 1),
 (&#39;Michael Cimino&#39;, 1),
 (&#39;Michael Curtiz&#39;, 1),
 (&#39;Michel Hazanavicius&#39;, 1),
 (&#39;Miloš Forman&#39;, 2),
 (&#39;Norman Jewison&#39;, 1),
 (&#39;Paul Haggis&#39;, 1),
 (&#39;Peter Farrelly&#39;, 1),
 (&#39;Peter Jackson&#39;, 1),
 (&#39;Richard Attenborough&#39;, 1),
 (&#39;Ridley Scott&#39;, 1),
 (&#39;Rob Marshall&#39;, 1),
 (&#39;Robert Benton&#39;, 1),
 (&#39;Robert Redford&#39;, 1),
 (&#39;Robert Rossen&#39;, 1),
 (&#39;Robert Wise&#39;, 1),
 (&#39;Robert Wise, Jerome Robbins&#39;, 1),
 (&#39;Robert Zemeckis&#39;, 1),
 (&#39;Robert Zigler Leonard&#39;, 1),
 (&#39;Ron Howard&#39;, 1),
 (&#39;Sam Mendes&#39;, 1),
 (&#39;Steve McQueen&#39;, 1),
 (&#39;Steven Spielberg, Marek Brodzki&#39;, 1),
 (&#39;Sydney Pollack&#39;, 1),
 (&#39;Tom Hooper&#39;, 1),
 (&#39;Tom McCarthy&#39;, 1),
 (&#39;Tony Richardson&#39;, 1),
 (&#39;Vincente Minnelli&#39;, 1),
 (&#39;Vincente Minnelli, Charles Walters&#39;, 1),
 (&#39;Wesley Ruggles&#39;, 1),
 (&#39;William A. Wellman, Harry d’Abbadie d’Arrast&#39;, 1),
 (&#39;William Dieterle&#39;, 1),
 (&#39;William Wyler&#39;, 3)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">director_counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Alejandro González Iñárritu 1
Alfred Hitchcock 1
Anthony Minghella 1
Barry Jenkins 1
Barry Levinson 1
Ben Affleck 1
Bernardo Bertolucci 1
Billy Wilder 2
Bong Joon-ho 1
Bruce Beresford 1
Carol Reed 1
Cecil B. DeMille 1
Clint Eastwood 2
Danny Boyle, Loveleen Tandan 1
David Lean 1
Delbert Mann, Paul Helmick 1
Edmund Goulding 1
Elia Kazan 2
Francis Ford Coppola 2
Frank Capra 2
Frank Lloyd 1
Fred Zinnemann 2
George Cukor 1
George Cukor, Victor Fleming, Sam Wood 1
George Roy Hill 1
Guillermo del Toro 1
Harry Beaumont 1
Hugh Hudson 1
James Cameron 1
James L. Brooks 1
Joel Coen, Ethan Coen 1
John Ford 1
John G. Avildsen 1
John Madden 1
John Schlesinger 1
Jonathan Demme 1
Joseph L. Mankiewicz 1
Kathryn Bigelow 1
Kevin Costner 1
Laurence Olivier 1
Leo McCarey 1
Lewis Milestone, Nate Watt 1
Martin Scorsese 1
Mel Gibson 1
Michael Cimino 1
Michael Curtiz 1
Michel Hazanavicius 1
Miloš Forman 2
Norman Jewison 1
Paul Haggis 1
Peter Farrelly 1
Peter Jackson 1
Richard Attenborough 1
Ridley Scott 1
Rob Marshall 1
Robert Benton 1
Robert Redford 1
Robert Rossen 1
Robert Wise 1
Robert Wise, Jerome Robbins 1
Robert Zemeckis 1
Robert Zigler Leonard 1
Ron Howard 1
Sam Mendes 1
Steve McQueen 1
Steven Spielberg, Marek Brodzki 1
Sydney Pollack 1
Tom Hooper 1
Tom McCarthy 1
Tony Richardson 1
Vincente Minnelli 1
Vincente Minnelli, Charles Walters 1
Wesley Ruggles 1
William A. Wellman, Harry d’Abbadie d’Arrast 1
William Dieterle 1
William Wyler 3
</pre></div>
</div>
</div>
</div>
</section>
<section id="adding-a-column">
<h3>Adding a column<a class="headerlink" href="#adding-a-column" title="Permalink to this headline">¶</a></h3>
<p>If we want to get the total number of actors per movie, we have to sum the values from the <code class="docutils literal notranslate"><span class="pre">male_cast</span></code> and <code class="docutils literal notranslate"><span class="pre">female_cast</span></code> columns.</p>
<p>You can do this in a for loop, by going over every row (like we saw above), but you can also sum the individual columns. Pandas will then add up the values with the same index and will return a new Series of the same length with the values summed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927-01-01</td>
      <td>1929-01-01</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929-01-01</td>
      <td>1930-01-01</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930-01-01</td>
      <td>1930-01-01</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931-01-01</td>
      <td>1931-01-01</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932-01-01</td>
      <td>1932-01-01</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015-01-01</td>
      <td>2016-01-01</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016-01-01</td>
      <td>2017-01-01</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017-01-01</td>
      <td>2018-01-01</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018-01-01</td>
      <td>2019-01-01</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019-01-01</td>
      <td>2020-01-01</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;female_cast&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     17
1      7
2     28
3     19
4     27
      ..
80    17
81     8
82    11
83     8
84    10
Length: 85, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_cast</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;male_cast&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;female_cast&#39;</span><span class="p">]</span>
<span class="n">total_cast</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     17
1      7
2     28
3     19
4     27
      ..
80    17
81     8
82    11
83     8
84    10
Length: 85, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Then, we add it as a column in our original dataframe. The only requirement for adding a column to a DataFrame is that the length of the Series or list is the same as that of the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;total_cast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_cast</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
      <th>total_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Wings</td>
      <td>tt0018578</td>
      <td>1927-01-01</td>
      <td>1929-01-01</td>
      <td>William A. Wellman, Harry d’Abbadie d’Arrast</td>
      <td>Paramount Pictures</td>
      <td>12</td>
      <td>5</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929-01-01</td>
      <td>1930-01-01</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>All Quiet on the Western Front</td>
      <td>tt0020629</td>
      <td>1930-01-01</td>
      <td>1930-01-01</td>
      <td>Lewis Milestone, Nate Watt</td>
      <td>Universal Pictures</td>
      <td>22</td>
      <td>6</td>
      <td>28</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cimarron</td>
      <td>tt0021746</td>
      <td>1931-01-01</td>
      <td>1931-01-01</td>
      <td>Wesley Ruggles</td>
      <td>RKO Pictures</td>
      <td>13</td>
      <td>6</td>
      <td>19</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grand Hotel</td>
      <td>tt0022958</td>
      <td>1932-01-01</td>
      <td>1932-01-01</td>
      <td>Edmund Goulding</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>19</td>
      <td>8</td>
      <td>27</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Spotlight</td>
      <td>tt1895587</td>
      <td>2015-01-01</td>
      <td>2016-01-01</td>
      <td>Tom McCarthy</td>
      <td>Anonymous Content, Participant</td>
      <td>15</td>
      <td>2</td>
      <td>17</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016-01-01</td>
      <td>2017-01-01</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>82</th>
      <td>The Shape of Water</td>
      <td>tt5580390</td>
      <td>2017-01-01</td>
      <td>2018-01-01</td>
      <td>Guillermo del Toro</td>
      <td>Searchlight Pictures, TSG Entertainment</td>
      <td>8</td>
      <td>3</td>
      <td>11</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018-01-01</td>
      <td>2019-01-01</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Parasite</td>
      <td>tt6751668</td>
      <td>2019-01-01</td>
      <td>2020-01-01</td>
      <td>Bong Joon-ho</td>
      <td>CJ Entertainment, Barunson E&amp;A</td>
      <td>5</td>
      <td>5</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 9 columns</p>
</div></div></div>
</div>
<p>Optionally, we can sort the DataFrame by column. For instance, from high to low (<code class="docutils literal notranslate"><span class="pre">ascending=False</span></code>) for the newly created <code class="docutils literal notranslate"><span class="pre">total_cast</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sorted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;total_cast&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_sorted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>imdb</th>
      <th>year</th>
      <th>award_year</th>
      <th>directors</th>
      <th>companies</th>
      <th>male_cast</th>
      <th>female_cast</th>
      <th>total_cast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59</th>
      <td>Forrest Gump</td>
      <td>tt0109830</td>
      <td>1994-01-01</td>
      <td>1995-01-01</td>
      <td>Robert Zemeckis</td>
      <td>Paramount Pictures</td>
      <td>89</td>
      <td>29</td>
      <td>118</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Gone with the Wind</td>
      <td>tt0031381</td>
      <td>1939-01-01</td>
      <td>1940-01-01</td>
      <td>George Cukor, Victor Fleming, Sam Wood</td>
      <td>Metro-Goldwyn-Mayer, Selznick International Pi...</td>
      <td>52</td>
      <td>20</td>
      <td>72</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Casablanca</td>
      <td>tt0034583</td>
      <td>1942-01-01</td>
      <td>1944-01-01</td>
      <td>Michael Curtiz</td>
      <td>Warner Bros.</td>
      <td>40</td>
      <td>8</td>
      <td>48</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Schindler's List</td>
      <td>tt0108052</td>
      <td>1993-01-01</td>
      <td>1994-01-01</td>
      <td>Steven Spielberg, Marek Brodzki</td>
      <td>Amblin Entertainment</td>
      <td>35</td>
      <td>11</td>
      <td>46</td>
    </tr>
    <tr>
      <th>41</th>
      <td>The Godfather Part II</td>
      <td>tt0071562</td>
      <td>1974-01-01</td>
      <td>1975-01-01</td>
      <td>Francis Ford Coppola</td>
      <td>Paramount Pictures</td>
      <td>33</td>
      <td>12</td>
      <td>45</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Driving Miss Daisy</td>
      <td>tt0097239</td>
      <td>1989-01-01</td>
      <td>1990-01-01</td>
      <td>Bruce Beresford</td>
      <td>Warner Bros.</td>
      <td>4</td>
      <td>4</td>
      <td>8</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Moonlight</td>
      <td>tt4975722</td>
      <td>2016-01-01</td>
      <td>2017-01-01</td>
      <td>Barry Jenkins</td>
      <td>Plan B Entertainment, A24</td>
      <td>6</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Green Book</td>
      <td>tt6966692</td>
      <td>2018-01-01</td>
      <td>2019-01-01</td>
      <td>Peter Farrelly</td>
      <td>Universal Pictures, DreamWorks, Participant, A...</td>
      <td>7</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Amadeus</td>
      <td>tt0086879</td>
      <td>1984-01-01</td>
      <td>1985-01-01</td>
      <td>Miloš Forman</td>
      <td>Orion Pictures</td>
      <td>5</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Broadway Melody</td>
      <td>tt0019729</td>
      <td>1929-01-01</td>
      <td>1930-01-01</td>
      <td>Harry Beaumont</td>
      <td>Metro-Goldwyn-Mayer</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="saving-back-the-file">
<h3>Saving back the file<a class="headerlink" href="#saving-back-the-file" title="Permalink to this headline">¶</a></h3>
<p>Use one of the <code class="docutils literal notranslate"><span class="pre">.to_csv()</span></code> or <code class="docutils literal notranslate"><span class="pre">.to_excel</span></code> functions to save the DataFrame. Again, no <code class="docutils literal notranslate"><span class="pre">with</span></code> statement needed, just a file path (and an encoding).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sorted</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;stuff/academyawards_sum.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sorted</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;stuff/academyawards_sum.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">61</span><span class="p">],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_sorted</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;stuff/academyawards_sum.xlsx&#39;</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/pandas/core/generic.py:2357,</span> in <span class="ni">NDFrame.to_excel</span><span class="nt">(self, excel_writer, sheet_name, na_rep, float_format, columns, header, index, index_label, startrow, startcol, engine, merge_cells, encoding, inf_rep, verbose, freeze_panes, storage_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">2344</span> <span class="kn">from</span> <span class="nn">pandas.io.formats.excel</span> <span class="kn">import</span> <span class="n">ExcelFormatter</span>
<span class="g g-Whitespace">   </span><span class="mi">2346</span> <span class="n">formatter</span> <span class="o">=</span> <span class="n">ExcelFormatter</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2347</span>     <span class="n">df</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2348</span>     <span class="n">na_rep</span><span class="o">=</span><span class="n">na_rep</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2355</span>     <span class="n">inf_rep</span><span class="o">=</span><span class="n">inf_rep</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2356</span> <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2357</span> <span class="n">formatter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2358</span>     <span class="n">excel_writer</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2359</span>     <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2360</span>     <span class="n">startrow</span><span class="o">=</span><span class="n">startrow</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2361</span>     <span class="n">startcol</span><span class="o">=</span><span class="n">startcol</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2362</span>     <span class="n">freeze_panes</span><span class="o">=</span><span class="n">freeze_panes</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2363</span>     <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2364</span>     <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2365</span> <span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/pandas/io/formats/excel.py:884,</span> in <span class="ni">ExcelFormatter.write</span><span class="nt">(self, writer, sheet_name, startrow, startcol, freeze_panes, engine, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="n">need_save</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>     <span class="c1"># error: Cannot instantiate abstract class &#39;ExcelWriter&#39; with abstract</span>
<span class="g g-Whitespace">    </span><span class="mi">883</span>     <span class="c1"># attributes &#39;engine&#39;, &#39;save&#39;, &#39;supported_extensions&#39; and &#39;write_cells&#39;</span>
<span class="ne">--&gt; </span><span class="mi">884</span>     <span class="n">writer</span> <span class="o">=</span> <span class="n">ExcelWriter</span><span class="p">(</span>  <span class="c1"># type: ignore[abstract]</span>
<span class="g g-Whitespace">    </span><span class="mi">885</span>         <span class="n">writer</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span>
<span class="g g-Whitespace">    </span><span class="mi">886</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">887</span>     <span class="n">need_save</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">889</span> <span class="k">try</span><span class="p">:</span>

<span class="nn">File ~/.local/lib/python3.8/site-packages/pandas/io/excel/_openpyxl.py:49,</span> in <span class="ni">OpenpyxlWriter.__init__</span><span class="nt">(self, path, engine, date_format, datetime_format, mode, storage_options, if_sheet_exists, engine_kwargs, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>     <span class="n">path</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>     <span class="c1"># Use the openpyxl module as the Excel writer.</span>
<span class="ne">---&gt; </span><span class="mi">49</span>     <span class="kn">from</span> <span class="nn">openpyxl.workbook</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="n">engine_kwargs</span> <span class="o">=</span> <span class="n">combine_kwargs</span><span class="p">(</span><span class="n">engine_kwargs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span>         <span class="n">path</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span>         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span>         <span class="n">engine_kwargs</span><span class="o">=</span><span class="n">engine_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span>     <span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;openpyxl&#39;
</pre></div>
</div>
</div>
</div>
<p>You need to specify <code class="docutils literal notranslate"><span class="pre">index=False</span></code> if you want to prevent a standard index (0,1,2,3…) to be saved in the file as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sorted</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;stuff/academyawards_sum.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Open the contents in Excel, LibreOffice Calc, or another program to read spreadsheets!</p>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="data-wrangling-example">
<h1>Data wrangling (example)<a class="headerlink" href="#data-wrangling-example" title="Permalink to this headline">¶</a></h1>
<p>We can take a look at another example. We consider a dataset of tweets from Elon Musk, SpaceX and Tesla founder, and ask the following questions:</p>
<ul class="simple">
<li><p>When is Elon most actively tweeting?</p></li>
</ul>
<p>While this question is a bit trivial, it will allow us to learn how to wrangle data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="load-dataset">
<h2>Load dataset<a class="headerlink" href="#load-dataset" title="Permalink to this headline">¶</a></h2>
<p>Let’s read in a CSV file containing an export of <a class="reference external" href="https://twitter.com/elonmusk">Elon Musk’s tweets</a>, exported from Twitter’s API.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_path</span> <span class="o">=</span> <span class="s1">&#39;data/elonmusk_tweets.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>created_at</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>849636868052275200</td>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>848988730585096192</td>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>848943072423497728</td>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
    </tr>
    <tr>
      <th>3</th>
      <td>848935705057280001</td>
      <td>2017-04-03 16:30:19</td>
      <td>Stormy weather in Shortville ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>848416049573658624</td>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2814</th>
      <td>142881284019060736</td>
      <td>2011-12-03 08:22:07</td>
      <td>That was a total non sequitur btw</td>
    </tr>
    <tr>
      <th>2815</th>
      <td>142880871391838208</td>
      <td>2011-12-03 08:20:28</td>
      <td>Great Voltaire quote, arguably better than Twa...</td>
    </tr>
    <tr>
      <th>2816</th>
      <td>142188458125963264</td>
      <td>2011-12-01 10:29:04</td>
      <td>I made the volume on the Model S http://t.co/w...</td>
    </tr>
    <tr>
      <th>2817</th>
      <td>142179928203460608</td>
      <td>2011-12-01 09:55:11</td>
      <td>Went to Iceland on Sat to ride bumper cars on ...</td>
    </tr>
    <tr>
      <th>2818</th>
      <td>15434727182</td>
      <td>2010-06-04 18:31:57</td>
      <td>Please ignore prior tweets, as that was someon...</td>
    </tr>
  </tbody>
</table>
<p>2819 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2819 entries, 0 to 2818
Data columns (total 3 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   id          2819 non-null   int64 
 1   created_at  2819 non-null   object
 2   text        2819 non-null   object
dtypes: int64(1), object(2)
memory usage: 66.2+ KB
</pre></div>
</div>
</div>
</div>
<p>Let’s give this dataset a bit more structure:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">id</span></code> column can be transformed into the dataframe’s index, thus enabling us e.g. to select a tweet by id;</p></li>
<li><p>The column <code class="docutils literal notranslate"><span class="pre">created_at</span></code> contains a timestamp, thus it can easily be converted into a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> value</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
      <td>Stormy weather in Shortville ...</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>142881284019060736</th>
      <td>2011-12-03 08:22:07</td>
      <td>That was a total non sequitur btw</td>
    </tr>
    <tr>
      <th>142880871391838208</th>
      <td>2011-12-03 08:20:28</td>
      <td>Great Voltaire quote, arguably better than Twa...</td>
    </tr>
    <tr>
      <th>142188458125963264</th>
      <td>2011-12-01 10:29:04</td>
      <td>I made the volume on the Model S http://t.co/w...</td>
    </tr>
    <tr>
      <th>142179928203460608</th>
      <td>2011-12-01 09:55:11</td>
      <td>Went to Iceland on Sat to ride bumper cars on ...</td>
    </tr>
    <tr>
      <th>15434727182</th>
      <td>2010-06-04 18:31:57</td>
      <td>Please ignore prior tweets, as that was someon...</td>
    </tr>
  </tbody>
</table>
<p>2819 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 2819 entries, 849636868052275200 to 15434727182
Data columns (total 2 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   created_at  2819 non-null   datetime64[ns]
 1   text        2819 non-null   object        
dtypes: datetime64[ns](1), object(1)
memory usage: 66.1+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
      <td>Stormy weather in Shortville ...</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>142881284019060736</th>
      <td>2011-12-03 08:22:07</td>
      <td>That was a total non sequitur btw</td>
    </tr>
    <tr>
      <th>142880871391838208</th>
      <td>2011-12-03 08:20:28</td>
      <td>Great Voltaire quote, arguably better than Twa...</td>
    </tr>
    <tr>
      <th>142188458125963264</th>
      <td>2011-12-01 10:29:04</td>
      <td>I made the volume on the Model S http://t.co/w...</td>
    </tr>
    <tr>
      <th>142179928203460608</th>
      <td>2011-12-01 09:55:11</td>
      <td>Went to Iceland on Sat to ride bumper cars on ...</td>
    </tr>
    <tr>
      <th>15434727182</th>
      <td>2010-06-04 18:31:57</td>
      <td>Please ignore prior tweets, as that was someon...</td>
    </tr>
  </tbody>
</table>
<p>2819 rows × 2 columns</p>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="selection">
<h2>Selection<a class="headerlink" href="#selection" title="Permalink to this headline">¶</a></h2>
<section id="renaming-columns">
<h3>Renaming columns<a class="headerlink" href="#renaming-columns" title="Permalink to this headline">¶</a></h3>
<p>An operation on dataframes that you’ll find yourself doing very often is to rename the columns. The first way of renaming columns is by manipulating directly the dataframe’s index via the <code class="docutils literal notranslate"><span class="pre">columns</span></code> property.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;created_at&#39;, &#39;text&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can change the column names by assigning to <code class="docutils literal notranslate"><span class="pre">columns</span></code> a list having as values the new column names.</p>
<p><strong>NB</strong>: the size of the list and new number of colums must match!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we renamed the column `text` =&gt; `tweet`</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;tweet&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s check that the change did take place</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>tweet</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
      <td>Stormy weather in Shortville ...</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The second way of renaming colums is to use the method <code class="docutils literal notranslate"><span class="pre">rename()</span></code> of a dataframe. The <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter takes a dictionary of mappings between old and new column names.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mapping_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;old_column_name&quot;</span><span class="p">:</span> <span class="s2">&quot;new_column_name&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s change column `tweet` =&gt; `text`</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tweet&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
      <td>Stormy weather in Shortville ...</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Question</strong>: in which cases is it more convenient to use the second method over the first?</p>
</section>
<section id="selecting-columns">
<h3>Selecting columns<a class="headerlink" href="#selecting-columns" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this selects one single column and returns as a Series</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;created_at&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
849636868052275200   2017-04-05 14:56:29
848988730585096192   2017-04-03 20:01:01
848943072423497728   2017-04-03 16:59:35
848935705057280001   2017-04-03 16:30:19
848416049573658624   2017-04-02 06:05:23
Name: created_at, dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;created_at&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># whereas this syntax selects one single column</span>
<span class="c1"># but returns a Dataframe</span>
<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;created_at&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;created_at&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
</section>
<section id="selecting-rows">
<h3>Selecting rows<a class="headerlink" href="#selecting-rows" title="Permalink to this headline">¶</a></h3>
<p>Filtering rows in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is done by means of <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code>, which can contain the row number as well as a condition for the selection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="transformation">
<h2>Transformation<a class="headerlink" href="#transformation" title="Permalink to this headline">¶</a></h2>
<p>The two main functions used to manipulate and transform values in a dataframe are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.map()</span></code> (on Series only!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.apply()</span></code></p></li>
</ul>
<p>In this section we’ll be using both to enrich our datasets with useful information (useful for exploration, for later visualizations, etc.).</p>
<section id="add-link-to-original-tweet">
<h3>Add link to original tweet<a class="headerlink" href="#add-link-to-original-tweet" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">map()</span></code> method can be called on a column, as well as on the dataframe’s index.</p>
<p>When passed as a parameter to <code class="docutils literal notranslate"><span class="pre">map</span></code>, an ‘anonymous’ lambda function <code class="docutils literal notranslate"><span class="pre">lambda</span></code> can be used to transform any value from that column into another one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tweet_link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;https://twitter.com/i/web/status/</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Or, maybe it is easier with a list comprehension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tweet_link&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;https://twitter.com/i/web/status/</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
      <td>https://twitter.com/i/web/status/8496368680522...</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
      <td>https://twitter.com/i/web/status/8489887305850...</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
      <td>https://twitter.com/i/web/status/8489430724234...</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
      <td>Stormy weather in Shortville ...</td>
      <td>https://twitter.com/i/web/status/8489357050572...</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
      <td>https://twitter.com/i/web/status/8484160495736...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>142881284019060736</th>
      <td>2011-12-03 08:22:07</td>
      <td>That was a total non sequitur btw</td>
      <td>https://twitter.com/i/web/status/1428812840190...</td>
    </tr>
    <tr>
      <th>142880871391838208</th>
      <td>2011-12-03 08:20:28</td>
      <td>Great Voltaire quote, arguably better than Twa...</td>
      <td>https://twitter.com/i/web/status/1428808713918...</td>
    </tr>
    <tr>
      <th>142188458125963264</th>
      <td>2011-12-01 10:29:04</td>
      <td>I made the volume on the Model S http://t.co/w...</td>
      <td>https://twitter.com/i/web/status/1421884581259...</td>
    </tr>
    <tr>
      <th>142179928203460608</th>
      <td>2011-12-01 09:55:11</td>
      <td>Went to Iceland on Sat to ride bumper cars on ...</td>
      <td>https://twitter.com/i/web/status/1421799282034...</td>
    </tr>
    <tr>
      <th>15434727182</th>
      <td>2010-06-04 18:31:57</td>
      <td>Please ignore prior tweets, as that was someon...</td>
      <td>https://twitter.com/i/web/status/15434727182</td>
    </tr>
  </tbody>
</table>
<p>2819 rows × 3 columns</p>
</div></div></div>
</div>
</section>
<section id="add-colums-with-mentions">
<h3>Add colums with mentions<a class="headerlink" href="#add-colums-with-mentions" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">find_mentions</span><span class="p">(</span><span class="n">tweet_text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find all @ mentions in a tweet and </span>
<span class="sd">    return them as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;@[a-zA-Z0-9_]{1,15}&#39;</span>
    <span class="n">mentions</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">tweet_text</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">mentions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tweet_mentions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">find_mentions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;n_mentions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">tweet_mentions</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
      <th>tweet_mentions</th>
      <th>n_mentions</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
      <td>https://twitter.com/i/web/status/8496368680522...</td>
      <td>[]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
      <td>https://twitter.com/i/web/status/8489887305850...</td>
      <td>[@ForIn2020, @waltmossberg, @mims, @defcon_5]</td>
      <td>4</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
      <td>https://twitter.com/i/web/status/8489430724234...</td>
      <td>[@waltmossberg, @mims, @defcon_5]</td>
      <td>3</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
      <td>Stormy weather in Shortville ...</td>
      <td>https://twitter.com/i/web/status/8489357050572...</td>
      <td>[]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
      <td>https://twitter.com/i/web/status/8484160495736...</td>
      <td>[@DaveLeeBBC, @verge]</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="add-column-with-week-day-and-hour">
<h3>Add column with week day and hour<a class="headerlink" href="#add-column-with-week-day-and-hour" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">day_of_week</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the week day name from a week day integer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Monday&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Tuesday&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Wednesday&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Thursday&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Friday&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Saturday&quot;</span>
    <span class="k">elif</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Sunday&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;week_day&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;week_day_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;week_day&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">day_of_week</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Or, there is a built-in function in Pandas that gives back the day name:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;week_day_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
      <th>tweet_mentions</th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>week_day_name</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
      <td>https://twitter.com/i/web/status/8496368680522...</td>
      <td>[]</td>
      <td>0</td>
      <td>2</td>
      <td>Wednesday</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
      <td>https://twitter.com/i/web/status/8489887305850...</td>
      <td>[@ForIn2020, @waltmossberg, @mims, @defcon_5]</td>
      <td>4</td>
      <td>0</td>
      <td>Monday</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
      <td>https://twitter.com/i/web/status/8489430724234...</td>
      <td>[@waltmossberg, @mims, @defcon_5]</td>
      <td>3</td>
      <td>0</td>
      <td>Monday</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="add-column-with-day-hour">
<h3>Add column with day hour<a class="headerlink" href="#add-column-with-day-hour" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.created_at.dt<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id
849636868052275200    14
848988730585096192    20
848943072423497728    16
848935705057280001    16
848416049573658624     6
Name: created_at, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;day_hour&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">,</span> <span class="s1">&#39;day_hour&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="n">display_cols</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>week_day</th>
      <th>day_hour</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>2</td>
      <td>14</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>0</td>
      <td>16</td>
    </tr>
    <tr>
      <th>848935705057280001</th>
      <td>2017-04-03 16:30:19</td>
      <td>0</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="multiple-conditions">
<h4>Multiple conditions<a class="headerlink" href="#multiple-conditions" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># AND condition with `&amp;`</span>

<span class="n">df</span><span class="p">[</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">week_day_name</span> <span class="o">==</span> <span class="s1">&#39;Saturday&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">n_mentions</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(187, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Equivalent expression with `query()`</span>

<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;week_day_name == &#39;Saturday&#39; and n_mentions == 0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(187, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># OR condition with `|`</span>

<span class="n">df</span><span class="p">[</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">week_day_name</span> <span class="o">==</span> <span class="s1">&#39;Saturday&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">n_mentions</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1384, 8)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="aggregation">
<h2>Aggregation<a class="headerlink" href="#aggregation" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;n_mentions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_mentions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6</td>
    </tr>
    <tr>
      <th>sum</th>
      <td>2277</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h3>Grouping<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_by_day</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;week_day&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The head of a DataFrameGroupBy consists of the first</span>
<span class="c1"># n records for each group (see `help(grp_by_day.head)`)</span>

<span class="n">group_by_day</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
      <th>tweet_mentions</th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>week_day_name</th>
      <th>day_hour</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
      <td>https://twitter.com/i/web/status/8496368680522...</td>
      <td>[]</td>
      <td>0</td>
      <td>2</td>
      <td>Wednesday</td>
      <td>14</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
      <td>https://twitter.com/i/web/status/8489887305850...</td>
      <td>[@ForIn2020, @waltmossberg, @mims, @defcon_5]</td>
      <td>4</td>
      <td>0</td>
      <td>Monday</td>
      <td>20</td>
    </tr>
    <tr>
      <th>848416049573658624</th>
      <td>2017-04-02 06:05:23</td>
      <td>@DaveLeeBBC @verge Coal is dying due to nat ga...</td>
      <td>https://twitter.com/i/web/status/8484160495736...</td>
      <td>[@DaveLeeBBC, @verge]</td>
      <td>2</td>
      <td>6</td>
      <td>Sunday</td>
      <td>6</td>
    </tr>
    <tr>
      <th>848244577521647616</th>
      <td>2017-04-01 18:44:01</td>
      <td>Why did we waste so much time developing silly...</td>
      <td>https://twitter.com/i/web/status/8482445775216...</td>
      <td>[]</td>
      <td>0</td>
      <td>5</td>
      <td>Saturday</td>
      <td>18</td>
    </tr>
    <tr>
      <th>847958571895619584</th>
      <td>2017-03-31 23:47:32</td>
      <td>@BadAstronomer We can def bring it back like D...</td>
      <td>https://twitter.com/i/web/status/8479585718956...</td>
      <td>[@BadAstronomer]</td>
      <td>1</td>
      <td>4</td>
      <td>Friday</td>
      <td>23</td>
    </tr>
    <tr>
      <th>847594208219336705</th>
      <td>2017-03-30 23:39:41</td>
      <td>Incredibly proud of the SpaceX team for achiev...</td>
      <td>https://twitter.com/i/web/status/8475942082193...</td>
      <td>[]</td>
      <td>0</td>
      <td>3</td>
      <td>Thursday</td>
      <td>23</td>
    </tr>
    <tr>
      <th>846772378067648513</th>
      <td>2017-03-28 17:14:01</td>
      <td>@danahull Very few. We have yet to do a China ...</td>
      <td>https://twitter.com/i/web/status/8467723780676...</td>
      <td>[@danahull]</td>
      <td>1</td>
      <td>1</td>
      <td>Tuesday</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">agg</span></code> is used to pass an aggregation function to be applied to each group resulting from <code class="docutils literal notranslate"><span class="pre">groupby</span></code>.</p>
<p>Here we are interested in how many tweets there are for each group, so we pass <code class="docutils literal notranslate"><span class="pre">len()</span></code> to an ‘aggregate’. This is similar to the <code class="docutils literal notranslate"><span class="pre">.count()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_by_day</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
      <th>tweet_mentions</th>
      <th>n_mentions</th>
      <th>week_day_name</th>
      <th>day_hour</th>
    </tr>
    <tr>
      <th>week_day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>315</td>
      <td>315</td>
      <td>315</td>
      <td>315</td>
      <td>315</td>
      <td>315</td>
      <td>315</td>
    </tr>
    <tr>
      <th>1</th>
      <td>385</td>
      <td>385</td>
      <td>385</td>
      <td>385</td>
      <td>385</td>
      <td>385</td>
      <td>385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>380</td>
      <td>380</td>
      <td>380</td>
      <td>380</td>
      <td>380</td>
      <td>380</td>
      <td>380</td>
    </tr>
    <tr>
      <th>3</th>
      <td>361</td>
      <td>361</td>
      <td>361</td>
      <td>361</td>
      <td>361</td>
      <td>361</td>
      <td>361</td>
    </tr>
    <tr>
      <th>4</th>
      <td>530</td>
      <td>530</td>
      <td>530</td>
      <td>530</td>
      <td>530</td>
      <td>530</td>
      <td>530</td>
    </tr>
    <tr>
      <th>5</th>
      <td>426</td>
      <td>426</td>
      <td>426</td>
      <td>426</td>
      <td>426</td>
      <td>426</td>
      <td>426</td>
    </tr>
    <tr>
      <th>6</th>
      <td>422</td>
      <td>422</td>
      <td>422</td>
      <td>422</td>
      <td>422</td>
      <td>422</td>
      <td>422</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>However, we are not interested in having the count for all columns. Rather we want to create a new dataframe with renamed column names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_by_day</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;tweet_count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tweet_count</th>
    </tr>
    <tr>
      <th>week_day</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>315</td>
    </tr>
    <tr>
      <th>1</th>
      <td>385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>380</td>
    </tr>
    <tr>
      <th>3</th>
      <td>361</td>
    </tr>
    <tr>
      <th>4</th>
      <td>530</td>
    </tr>
    <tr>
      <th>5</th>
      <td>426</td>
    </tr>
    <tr>
      <th>6</th>
      <td>422</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="by-label-column">
<h4>By label (column)<a class="headerlink" href="#by-label-column" title="Permalink to this headline">¶</a></h4>
<p>Previously we’ve added a column indicating on which day of the week a given tweet appeared.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groupby_result_as_series</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day_hour&#39;</span><span class="p">)[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groupby_result_as_series</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>day_hour
0     144
1     183
2     119
3     104
4      98
5      81
6      85
7      94
8      82
9      55
10     34
11     15
12     17
13     23
14    114
15    190
16    198
17    190
18    162
19    154
20    176
21    192
22    168
23    141
Name: text, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groupby_result_as_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day_hour&#39;</span><span class="p">)[[</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span>\
    <span class="o">.</span><span class="n">count</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groupby_result_as_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>day_hour</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>144</td>
    </tr>
    <tr>
      <th>1</th>
      <td>183</td>
    </tr>
    <tr>
      <th>2</th>
      <td>119</td>
    </tr>
    <tr>
      <th>3</th>
      <td>104</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="by-series-or-dict">
<h4>By series or dict<a class="headerlink" href="#by-series-or-dict" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.groupby<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we pass the groups as a series</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="nb">len</span><span class="p">})</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
    <tr>
      <th>created_at</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>114</td>
    </tr>
    <tr>
      <th>4</th>
      <td>97</td>
    </tr>
    <tr>
      <th>5</th>
      <td>117</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we pass the groups as a series</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="p">)[[</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
    <tr>
      <th>created_at</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>114</td>
    </tr>
    <tr>
      <th>4</th>
      <td>97</td>
    </tr>
    <tr>
      <th>5</th>
      <td>117</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">)[[</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
    <tr>
      <th>created_at</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>144</td>
    </tr>
    <tr>
      <th>1</th>
      <td>183</td>
    </tr>
    <tr>
      <th>2</th>
      <td>119</td>
    </tr>
    <tr>
      <th>3</th>
      <td>104</td>
    </tr>
    <tr>
      <th>4</th>
      <td>98</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="by-multiple-labels-columns">
<h4>By multiple labels (columns)<a class="headerlink" href="#by-multiple-labels-columns" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we group based on the values of two columns</span>
<span class="c1"># instead of one</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;week_day&#39;</span><span class="p">,</span> <span class="s1">&#39;day_hour&#39;</span><span class="p">])[[</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>text</th>
    </tr>
    <tr>
      <th>week_day</th>
      <th>day_hour</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="aggregation-methods">
<h3>Aggregation methods<a class="headerlink" href="#aggregation-methods" title="Permalink to this headline">¶</a></h3>
<p><strong>Summary</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">count</span></code>: Number of non-NA values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sum</span></code>: Sum of non-NA values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>: Mean of non-NA values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">median</span></code>: Arithmetic median of non-NA values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std</span></code>, <code class="docutils literal notranslate"><span class="pre">var</span></code>: standard deviation and variance</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>: Minimum and maximum of non-NA values</p></li>
</ul>
<p>You can also use these in an aggregation functions within a groupby:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;week_day&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="c1"># each key in this dict specifies</span>
        <span class="c1"># a given column</span>
        <span class="s1">&#39;n_mentions&#39;</span><span class="p">:[</span>
            <span class="c1"># the list contains aggregation functions</span>
            <span class="c1"># to be applied to this column</span>
            <span class="s1">&#39;count&#39;</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">,</span>
            <span class="s1">&#39;var&#39;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">n_mentions</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>min</th>
      <th>max</th>
      <th>std</th>
      <th>var</th>
    </tr>
    <tr>
      <th>week_day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>315</td>
      <td>0.812698</td>
      <td>0</td>
      <td>5</td>
      <td>0.964248</td>
      <td>0.929775</td>
    </tr>
    <tr>
      <th>1</th>
      <td>385</td>
      <td>0.729870</td>
      <td>0</td>
      <td>6</td>
      <td>0.874861</td>
      <td>0.765381</td>
    </tr>
    <tr>
      <th>2</th>
      <td>380</td>
      <td>0.786842</td>
      <td>0</td>
      <td>4</td>
      <td>0.768328</td>
      <td>0.590328</td>
    </tr>
    <tr>
      <th>3</th>
      <td>361</td>
      <td>0.781163</td>
      <td>0</td>
      <td>4</td>
      <td>0.832853</td>
      <td>0.693644</td>
    </tr>
    <tr>
      <th>4</th>
      <td>530</td>
      <td>0.879245</td>
      <td>0</td>
      <td>5</td>
      <td>0.901869</td>
      <td>0.813368</td>
    </tr>
    <tr>
      <th>5</th>
      <td>426</td>
      <td>0.727700</td>
      <td>0</td>
      <td>5</td>
      <td>0.800607</td>
      <td>0.640972</td>
    </tr>
    <tr>
      <th>6</th>
      <td>422</td>
      <td>0.907583</td>
      <td>0</td>
      <td>6</td>
      <td>0.851707</td>
      <td>0.725406</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="sorting">
<h3>Sorting<a class="headerlink" href="#sorting" title="Permalink to this headline">¶</a></h3>
<p>To sort the values of  a dataframe we use its <code class="docutils literal notranslate"><span class="pre">sort_values</span></code> method:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">by</span></code>: specifies the name of the column to be used for sorting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ascending</span></code> (default = <code class="docutils literal notranslate"><span class="pre">True</span></code>): specifies whether the sorting should be <em>ascending</em> (A-Z, 0-9) or <code class="docutils literal notranslate"><span class="pre">descending</span></code> (Z-A, 9-0)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
      <th>tweet_mentions</th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>week_day_name</th>
      <th>day_hour</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15434727182</th>
      <td>2010-06-04 18:31:57</td>
      <td>Please ignore prior tweets, as that was someon...</td>
      <td>https://twitter.com/i/web/status/15434727182</td>
      <td>[]</td>
      <td>0</td>
      <td>4</td>
      <td>Friday</td>
      <td>18</td>
    </tr>
    <tr>
      <th>142179928203460608</th>
      <td>2011-12-01 09:55:11</td>
      <td>Went to Iceland on Sat to ride bumper cars on ...</td>
      <td>https://twitter.com/i/web/status/1421799282034...</td>
      <td>[]</td>
      <td>0</td>
      <td>3</td>
      <td>Thursday</td>
      <td>9</td>
    </tr>
    <tr>
      <th>142188458125963264</th>
      <td>2011-12-01 10:29:04</td>
      <td>I made the volume on the Model S http://t.co/w...</td>
      <td>https://twitter.com/i/web/status/1421884581259...</td>
      <td>[]</td>
      <td>0</td>
      <td>3</td>
      <td>Thursday</td>
      <td>10</td>
    </tr>
    <tr>
      <th>142880871391838208</th>
      <td>2011-12-03 08:20:28</td>
      <td>Great Voltaire quote, arguably better than Twa...</td>
      <td>https://twitter.com/i/web/status/1428808713918...</td>
      <td>[]</td>
      <td>0</td>
      <td>5</td>
      <td>Saturday</td>
      <td>8</td>
    </tr>
    <tr>
      <th>142881284019060736</th>
      <td>2011-12-03 08:22:07</td>
      <td>That was a total non sequitur btw</td>
      <td>https://twitter.com/i/web/status/1428812840190...</td>
      <td>[]</td>
      <td>0</td>
      <td>5</td>
      <td>Saturday</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;n_mentions&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
      <th>tweet_mentions</th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>week_day_name</th>
      <th>day_hour</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>752721031735812096</th>
      <td>2016-07-12 04:27:33</td>
      <td>@kumailn @RealDaveBarton @JuddApatow @SiliconH...</td>
      <td>https://twitter.com/i/web/status/7527210317358...</td>
      <td>[@kumailn, @RealDaveBarton, @JuddApatow, @Sili...</td>
      <td>6</td>
      <td>1</td>
      <td>Tuesday</td>
      <td>4</td>
    </tr>
    <tr>
      <th>303244501957365760</th>
      <td>2013-02-17 20:48:17</td>
      <td>RT @LawrenceChanin: @TeslaRoadTrip @avantgame ...</td>
      <td>https://twitter.com/i/web/status/3032445019573...</td>
      <td>[@LawrenceChanin, @TeslaRoadTrip, @avantgame, ...</td>
      <td>6</td>
      <td>6</td>
      <td>Sunday</td>
      <td>20</td>
    </tr>
    <tr>
      <th>845289977051148289</th>
      <td>2017-03-24 15:03:29</td>
      <td>@faultywarrior @matt_trulli @FredericLambert @...</td>
      <td>https://twitter.com/i/web/status/8452899770511...</td>
      <td>[@faultywarrior, @matt_trulli, @FredericLamber...</td>
      <td>5</td>
      <td>4</td>
      <td>Friday</td>
      <td>15</td>
    </tr>
    <tr>
      <th>672792504895434753</th>
      <td>2015-12-04 15:00:07</td>
      <td>RT @WSJLife: Supermodel @KarlieKloss blasts of...</td>
      <td>https://twitter.com/i/web/status/6727925048954...</td>
      <td>[@WSJLife, @KarlieKloss, @elonmusk, @spacex, @...</td>
      <td>5</td>
      <td>4</td>
      <td>Friday</td>
      <td>15</td>
    </tr>
    <tr>
      <th>191005784862236672</th>
      <td>2012-04-14 03:31:42</td>
      <td>RT @SethGreen: My love @ClareGrant &amp; @elonmusk...</td>
      <td>https://twitter.com/i/web/status/1910057848622...</td>
      <td>[@SethGreen, @ClareGrant, @elonmusk, @SpaceX, ...</td>
      <td>5</td>
      <td>5</td>
      <td>Saturday</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="save">
<h2>Save<a class="headerlink" href="#save" title="Permalink to this headline">¶</a></h2>
<p>Before continuing with the plotting, let’s save our enhanced dataframe, so that we can come back to it without having to redo the same manipulations on it.</p>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides a number of handy functions to export dataframes in a variety of formats.</p>
<p>Here we use <code class="docutils literal notranslate"><span class="pre">.to_pickle()</span></code> to serialize the dataframe into a binary format, by using behind the scenes Python’s <code class="docutils literal notranslate"><span class="pre">pickle</span></code> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;stuff/musk_tweets_enhanced.pickle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-2">
<h2>Part 2<a class="headerlink" href="#part-2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s2">&quot;stuff/musk_tweets_enhanced.pickle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="describe">
<h3><code class="docutils literal notranslate"><span class="pre">describe()</span></code><a class="headerlink" href="#describe" title="Permalink to this headline">¶</a></h3>
<p>The default behavior is to include only column with numerical values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>day_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2819.000000</td>
      <td>2819.000000</td>
      <td>2819.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.807733</td>
      <td>3.196169</td>
      <td>12.782547</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.859091</td>
      <td>1.946637</td>
      <td>7.611198</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>5.000000</td>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>23.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A trick to include more values is to exclude the datatype on which it breaks, which in our case is <code class="docutils literal notranslate"><span class="pre">list</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_60787/4047585927.py:1: FutureWarning: Treating datetime data as categorical rather than numeric in `.describe` is deprecated and will be removed in a future version of pandas. Specify `datetime_is_numeric=True` to silence this warning and adopt the future behavior now.
  df.describe(exclude=[list])
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>day_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2819</td>
      <td>2819.000000</td>
      <td>2819.000000</td>
      <td>2819.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2819</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>2017-04-05 14:56:29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>first</th>
      <td>2010-06-04 18:31:57</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>last</th>
      <td>2017-04-05 14:56:29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>0.807733</td>
      <td>3.196169</td>
      <td>12.782547</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>0.859091</td>
      <td>1.946637</td>
      <td>7.611198</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>5.000000</td>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>23.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">datetime_is_numeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count                             2819
mean     2015-03-24 20:24:24.578928896
min                2010-06-04 18:31:57
25%                2013-06-28 18:27:19
50%                2015-10-21 23:14:33
75%                2016-08-30 04:08:30
max                2017-04-05 14:56:29
Name: created_at, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;week_day_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;week_day_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_60787/1424112182.py:1: FutureWarning: Treating datetime data as categorical rather than numeric in `.describe` is deprecated and will be removed in a future version of pandas. Specify `datetime_is_numeric=True` to silence this warning and adopt the future behavior now.
  df.describe(exclude=[&#39;object&#39;])
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>week_day_name</th>
      <th>day_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2819</td>
      <td>2819.000000</td>
      <td>2819.000000</td>
      <td>2819</td>
      <td>2819.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2819</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>2017-04-05 14:56:29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Friday</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>530</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>first</th>
      <td>2010-06-04 18:31:57</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>last</th>
      <td>2017-04-05 14:56:29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>0.807733</td>
      <td>3.196169</td>
      <td>NaN</td>
      <td>12.782547</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>0.859091</td>
      <td>1.946637</td>
      <td>NaN</td>
      <td>7.611198</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>NaN</td>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>5.000000</td>
      <td>NaN</td>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>NaN</td>
      <td>23.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id2">
<h3>Plotting<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Not needed in newest Pandas version</span>
<span class="o">%</span><span class="k">matplotlib</span> inline 

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="histograms">
<h4>Histograms<a class="headerlink" href="#histograms" title="Permalink to this headline">¶</a></h4>
<p>They are useful to see the distribution of a certain variable in your dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;n_mentions&#39;</span><span class="p">])[[</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
    <tr>
      <th>n_mentions</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1145</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1231</td>
    </tr>
    <tr>
      <th>2</th>
      <td>329</td>
    </tr>
    <tr>
      <th>3</th>
      <td>78</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">n_mentions</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of the number of mentions per tweet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tweets&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Mentions (per tweet)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_PandasDataWrangling_229_0.png" src="../_images/4_PandasDataWrangling_229_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">day_hour</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of the number of mentions per tweet&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tweets&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Hour of the day&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_PandasDataWrangling_230_0.png" src="../_images/4_PandasDataWrangling_230_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2017</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2017</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_2017</span><span class="o">.</span><span class="n">day_hour</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Year 2017&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tweets&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Hour of the day&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_PandasDataWrangling_232_0.png" src="../_images/4_PandasDataWrangling_232_0.png" />
</div>
</div>
<p>So far we have used directly <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to generate our plots.</p>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>’s dataframes provide some methods that directly call <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>’s API behind the scenes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hist()</span></code> for histograms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boxplot()</span></code> for boxplots</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot()</span></code> for other types of plots (specified with e.g. <code class="docutils literal notranslate"><span class="pre">any='scatter'</span></code>)</p></li>
</ul>
<p>By passing the <code class="docutils literal notranslate"><span class="pre">by</span></code> parameter to e.g. <code class="docutils literal notranslate"><span class="pre">hist()</span></code> it is possible to produce one histogram plot of a given variable for each value in another column.</p>
<p>Let’s see how we can plot the number of mentions by year:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;day_hour&#39;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_PandasDataWrangling_237_0.png" src="../_images/4_PandasDataWrangling_237_0.png" />
</div>
</div>
</section>
<section id="bar-charts">
<h4>Bar charts<a class="headerlink" href="#bar-charts" title="Permalink to this headline">¶</a></h4>
<p>They are useful to plot categorical data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.bar<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tweets_by_weekday</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">created_at</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span><span class="p">)[[</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">week_days</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Mon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Tue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Wed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Thur&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Fri&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sun&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># specify the type of plot and the labels</span>
<span class="c1"># for the y axis (the bars)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">tweets_by_weekday</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">tweets_by_weekday</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
    <span class="n">tick_label</span><span class="o">=</span><span class="n">week_days</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>

<span class="c1"># give a title to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Elon Musk</span><span class="se">\&#39;</span><span class="s1">s week on Twitter&#39;</span><span class="p">)</span>

<span class="c1"># give a label to the axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of tweets&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Week day&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_PandasDataWrangling_242_0.png" src="../_images/4_PandasDataWrangling_242_0.png" />
</div>
</div>
</section>
<section id="box-plots">
<h4>Box plots<a class="headerlink" href="#box-plots" title="Permalink to this headline">¶</a></h4>
<p><img alt="box plot explained" src="https://github.com/bloemj/2022-coding-the-humanities/blob/master/notebooks/images/eda-boxplot.png?raw=1" /></p>
</section>
</section>
<section id="outliers-missing-values">
<h3>Outliers, missing values<a class="headerlink" href="#outliers-missing-values" title="Permalink to this headline">¶</a></h3>
<p>An <em>outlier</em> is an observation far from the center of mass of the distribution. It might be an error or a genuine observation: this distinction requires domain knowledge. Outliers infuence the outcomes of several statistics and machine learning methods: it is important to decide how to deal with them.</p>
<p>A <em>missing value</em> is an observation without a value. There can be many reasons for a missing value: the value might not exist (hence its absence is informative and it should be left empty) or might not be known (hence the value is existing but missing in the dataset and it should be marked as NA).</p>
<p><em>One way to think about the difference is with this Zen-like koan: An explicit missing value is the presence of an absence; an implicit missing value is the absence of a presence.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tweets_by_weekday</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
    <tr>
      <th>created_at</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>315</td>
    </tr>
    <tr>
      <th>1</th>
      <td>385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>380</td>
    </tr>
    <tr>
      <th>3</th>
      <td>361</td>
    </tr>
    <tr>
      <th>4</th>
      <td>530</td>
    </tr>
    <tr>
      <th>5</th>
      <td>426</td>
    </tr>
    <tr>
      <th>6</th>
      <td>422</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tweets_by_weekday</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>402.714286</td>
    </tr>
    <tr>
      <th>std</th>
      <td>67.551744</td>
    </tr>
    <tr>
      <th>min</th>
      <td>315.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>370.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>385.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>424.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>530.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tweets_by_weekday</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/4_PandasDataWrangling_247_1.png" src="../_images/4_PandasDataWrangling_247_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.bar<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_at</th>
      <th>text</th>
      <th>tweet_link</th>
      <th>tweet_mentions</th>
      <th>n_mentions</th>
      <th>week_day</th>
      <th>week_day_name</th>
      <th>day_hour</th>
      <th>year</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849636868052275200</th>
      <td>2017-04-05 14:56:29</td>
      <td>And so the robots spared humanity ... https://...</td>
      <td>https://twitter.com/i/web/status/8496368680522...</td>
      <td>[]</td>
      <td>0</td>
      <td>2</td>
      <td>Wednesday</td>
      <td>14</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>848988730585096192</th>
      <td>2017-04-03 20:01:01</td>
      <td>@ForIn2020 @waltmossberg @mims @defcon_5 Exact...</td>
      <td>https://twitter.com/i/web/status/8489887305850...</td>
      <td>[@ForIn2020, @waltmossberg, @mims, @defcon_5]</td>
      <td>4</td>
      <td>0</td>
      <td>Monday</td>
      <td>20</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>848943072423497728</th>
      <td>2017-04-03 16:59:35</td>
      <td>@waltmossberg @mims @defcon_5 Et tu, Walt?</td>
      <td>https://twitter.com/i/web/status/8489430724234...</td>
      <td>[@waltmossberg, @mims, @defcon_5]</td>
      <td>3</td>
      <td>0</td>
      <td>Monday</td>
      <td>16</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;day_hour&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>day_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2819.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>12.782547</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7.611198</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>15.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>23.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;day_hour&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>day_hour    5.0
Name: 0.25, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df.boxplot<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;day_hour&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day_name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="s1">&#39;week_day_name&#39;</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="c1"># give a title to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># give a label to the axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Day of the week&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_PandasDataWrangling_253_0.png" src="../_images/4_PandasDataWrangling_253_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;day_hour&#39;</span><span class="p">,</span> <span class="s1">&#39;week_day&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="s1">&#39;week_day&#39;</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># just to show the difference with/without</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="c1"># give a title to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># give a label to the axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Day of the week&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_PandasDataWrangling_254_0.png" src="../_images/4_PandasDataWrangling_254_0.png" />
</div>
</div>
</section>
<section id="exercise-1">
<h3>Exercise 1.<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Create a function that calculates the frequency of hashtags in tweets.</p></li>
<li><p>Test it on toy examples, to make sure it works.</p></li>
<li><p>Apply it to Elon Musk’s tweets.</p></li>
<li><p>List the top 10 hashtags in the dataset.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2.<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>Read the file <code class="docutils literal notranslate"><span class="pre">data/adams-hhgttg.txt</span></code> and:</p>
<ul class="simple">
<li><p>Count the number of occurrences per distinct word in the text.</p></li>
<li><p>Create a data frame with two columns: word and counts.</p></li>
<li><p>Plot the histogram of the word frequencies and think about what is happening.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here.</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="3_ReadingAndWritingFiles.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Reading and writing files, JSON</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="5_WorkingTweets.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Working with Tweets</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Joy Crosbie, Nils Peters<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>